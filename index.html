<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Dashboard</title>
    <!-- Boostrap and style -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css" />

    <!-- Moment, jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.0/moment.min.js" integrity="sha512-Izh34nqeeR7/nwthfeE0SI3c8uhFSnqxV0sI9TvTcXiFJkMd6fB644O64BRq2P/LA/+7eRvCw4GmLsXksyTHBg==" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
 
</head>
<body>
    
    <div class="container">
        <div class="row"><h1 class="h1">Weather Dashboard</h1></div>
     <div class="row">
         <h3>Search for a City </h3>
     </div> 
     <div class="row">   
         <input id="citySearch" type="text">
         <button id="buttonSearch" class="btn btn-info">Search</button>
     </div>
     <div  class="row">
         <div id="cities" class="col-md-3">
              
         </div>
         <div class="col-md-9">
             <div id="currentCity">Please type a City</div>
             <div class="row"><h3>5 days Forecast</h3></div>
          
            
                  <div id="cards-days" class="card-deck">
                  <!--Forecast for 5 days in cards-->    

                  </div>
             
        </div>
     </div>
    </div>


<script>
        var today = moment().format('LLL');
        console.log(today);
        var divP=$("#cards-days");     
 
// Search Button 
$(document).on("click", "#buttonSearch", searchCity);


//Searching City
function searchCity(){
    var cityL = $("#citySearch").val();
    if (cityL == ""){
       alert("Please type a City");
    }
    else{
        var btn = $("<button>");
        btn.addClass("btn btn-primary cities-btn");
        btn.text(cityL);
        btn.attr("data-city",cityL);
        $("#cities").prepend(btn);

            
    
    weatherCityDisplay(cityL);
    
     
    // clear Text area
    $("#citySearch").val("");
    
      }
    
}

// on click in the cities of the list

$(document).on("click", ".cities-btn", newCityDisplay);


function newCityDisplay(){
    var cityLista = $(this).attr("data-city");
    weatherCityDisplay(cityLista);
}


//shows data for that city
function weatherCityDisplay(city){

    var urlWeather = "http://api.openweathermap.org/data/2.5/weather?q=" + city + "&units=imperial&appid=99301d0cd337422b7e967fbf9be0bf70";



$.ajax({         
         url : urlWeather,
         method : "GET"}).
         then(function(response){
    
          //look info
        var nameCity = response.name;
        var tempCity = response.main.temp;
        var feelCity = response.main.feels_like;
        var humidityCity = response.main.humidity;
        var windCity = response.wind.speed;

        var divEl = $("#currentCity"); 
        
        //clear div w where show the city weather 
        divEl.empty();
        divP.empty();

        var nameC = $("<h1>").text(nameCity);
        divEl.append(nameC);

        

        var todayC = $("<div>").text(today);
        todayfC=moment().format('LL');
        divEl.append(todayfC);

        var tempC = $("<div>").text("Temperature : " + tempCity + "F");
        divEl.append(tempC);

        var feelC = $("<div>").text("Feels Like  : " + feelCity + "F");
        divEl.append(feelC);

        var humidityC = $("<div>").text("Humidity  : " + humidityCity +"%");
        divEl.append(humidityC);

        var windC = $("<div>").text("wind : " + windCity + "m/h");
        divEl.append(windC);
         
        
        weatherForecastDisplay(city); 
         });
         


// show Forecast of the city
    function weatherForecastDisplay(city){
             
        var urlForecast = "http://api.openweathermap.org/data/2.5/forecast?q="+city+"&units=imperial&appid=99301d0cd337422b7e967fbf9be0bf70";
   $.ajax({
       url:urlForecast,
       method: "GET"})
       .then(function(response){
       
       
        //getting info of each day
      for(var i=9; i < 42; i=i+8 ) {
         if(i > 33){
             i=39;
         }
      
         var dateWeather1 = response.list[i].dt_txt;
         var tempWeather1 = response.list[i].main.temp_max;
         var tempMWeather1 = response.list[i].main.temp_min;
         var humWeather1 = response.list[i].main.humidity;
         var skyWeather1 = response.list[i].weather[0].main;
         var imgskyWeather1 = response.list[i].weather[0].icon;
         var urlimgsky = "http://openweathermap.org/img/wn/"+imgskyWeather1+"@2x.png";


        //Making Cards
         var divP=$("#cards-days");
    
         var div1 = $("<div>");
             div1.addClass("card text-white bg-info");
         var div2 = $("<div>");
             div2.addClass("card-header");
             dateWeather = moment(dateWeather1).format('ll');
         var div2text=div2.text(dateWeather);    
         var div3 = $("<div>");
             div3.addClass("card-body");
         var p1 = $("<p>");
             p1.addClass("card-text letter-card");
         var p1text = p1.text(" Temp Max :" + tempMWeather1 + " F Temp Min ;"+ tempMWeather1+"F  Humidity : "+humWeather1+"% \n Sky :"+skyWeather1);
         


         divP.append(div1);
         div1.append(div2);
         div2.append(div3);
         div3.append(p1);
         
      }
    });
     
    }     
}


</script>
   
    
</body>
</html>